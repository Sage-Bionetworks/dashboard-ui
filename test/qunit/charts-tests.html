<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Chart Functions Tests</title>
    <link rel="stylesheet" href="qunit-1.12.0.css">
</head>
<body>
    <div id="qunit"></div>
    <div id="qunit-fixture"></div>
    <script src="qunit-1.12.0.js"></script>
    <script src="../../public/javascripts/d3-3.3.8.min.js"></script>
    <script src="../../public/javascripts/series-charts.js"></script>
    <script>

        test( "getSeriesTest", function() {

            var counts = {
                valueName: "Count",
                headers: ["Client", "All", "Public", "Non-Sage", "Public, Non-Sage"],
                values: [
                    ["web", 151, 121, 93, 77],
                    ["python", 95, 62, 79, 39],
                    ["r", 55, 32, 29, 6]
                ]
            };

            var expectedDataSeries = {
                xLabel: "Client",
                yLabel: "Count",
                headers: ["All", "Public", "Non-Sage", "Public, Non-Sage"],
                xSeries: ["web", "python", "r"],
                ySeries: [
                    {
                        header: "All",
                        values: [
                            {name: "web", value: 151},
                            {name: "python", value: 95},
                            {name: "r", value: 55}
                        ]
                    },{
                        header: "Public",
                        values: [
                            {name: "web", value: 121},
                            {name: "python", value: 62},
                            {name: "r", value: 32}
                        ]
                    },{
                        header: "Non-Sage",
                        values: [
                            {name: "web", value: 93},
                            {name: "python", value: 79},
                            {name: "r", value: 29}
                        ]
                    },{
                        header: "Public, Non-Sage",
                        values: [
                            {name: "web", value: 77},
                            {name: "python", value: 39},
                            {name: "r", value: 6}
                        ]
                    }
                ],
                xMin: "python",
                xMax: "web",
                yMin: 6,
                yMax: 151
            };

            var dataSeries = getSeries(counts);
            deepEqual(dataSeries, expectedDataSeries);
        });

        test( "getTimeSeriesTest", function() {

            var temperatures = {
                dateFormat: "%Y-%m",
                valueName: "Temperature",
                headers: ["Month", "Austin", "New York", "Seattle"],
                values: [
                    ["2013-01", 50, 33, 47],
                    ["2013-02", 52, 35, 51],
                    ["2013-03", 55, 42, 56]
                ]
            };

            var expectedTimeSeries = {
                xLabel: "Month",
                yLabel: "Temperature",
                xMin: new Date(2013, 0),
                xMax: new Date(2013, 2),
                yMin: 33,
                yMax: 56,
                headers: ["Austin", "New York", "Seattle"],
                xSeries: [new Date(2013, 0), new Date(2013, 1), new Date(2013, 2)],
                ySeries: [
                    {
                        header: "Austin",
                        values: [
                            {timestamp: new Date(2013, 0), value: 50},
                            {timestamp: new Date(2013, 1), value: 52},
                            {timestamp: new Date(2013, 2), value: 55}
                        ]
                    },{
                        header: "New York",
                        values: [
                            {timestamp: new Date(2013, 0), value: 33},
                            {timestamp: new Date(2013, 1), value: 35},
                            {timestamp: new Date(2013, 2), value: 42}
                        ]
                    },{
                        header: "Seattle",
                        values: [
                            {timestamp: new Date(2013, 0), value: 47},
                            {timestamp: new Date(2013, 1), value: 51},
                            {timestamp: new Date(2013, 2), value: 56}
                        ]
                    }
                ]
            };

            var timeSeries = getTimeSeries(temperatures);
            deepEqual(timeSeries, expectedTimeSeries);
        });

    </script>
</body>
</html>
